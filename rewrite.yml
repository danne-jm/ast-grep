type: specs.openrewrite.org/v1beta/recipe
name: com.yourorg.MigrationRules
displayName: My Project Migrations
description: Collection of migrations for my TS project.
recipeList:
  # 1. Update YAML Pipelines - Change task version
  - org.openrewrite.text.FindAndReplace:
      find: "MyTask@v1"
      replace: "MyTask@v2"
      filePattern: '**/*.yml'

  # 2. Update YAML Pipelines - Change command to script
  - org.openrewrite.yaml.ChangePropertyKey:
      oldPropertyKey: $.inputs.command
      newPropertyKey: script
      filePattern: '**/*.yml'

  # 3. Update JSON Config - Change logging value
  - org.openrewrite.json.ChangeValue:
      oldKeyPath: $.settings.logging
      value: '"debug"'

  - org.openrewrite.json.ChangeValue:
      oldKeyPath: $.features.analytics.logging
      value: '"debug"'

  - org.openrewrite.json.ChangeValue:
      oldKeyPath: $.features.notifications.logging
      value: '"debug"'

  - org.openrewrite.json.ChangeValue:
      oldKeyPath: $.monitoring.logging
      value: '"debug"'

  # 4. Simple Text Replacement for TS function name
  - org.openrewrite.text.FindAndReplace:
      find: oldServiceCall
      replace: newServiceCall
      filePattern: '**/*.ts'